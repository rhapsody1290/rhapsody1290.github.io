<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="Mr.Qian's Home">
<meta property="og:url" content="http://qianmingxs.com/page/9/index.html">
<meta property="og:site_name" content="Mr.Qian's Home">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mr.Qian's Home">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://qianmingxs.com/page/9/"/>





  <title>Mr.Qian's Home</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mr.Qian's Home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/27/[分布式架构]淘宝技术这十年——存储技术的发展/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/27/[分布式架构]淘宝技术这十年——存储技术的发展/" itemprop="url">淘宝技术这十年——存储技术的发展</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-27T14:52:00+08:00">
                2017-02-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式架构/" itemprop="url" rel="index">
                    <span itemprop="name">分布式架构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开发语言决不是系统的瓶颈，业务带来的压力多在于数据和存储方面，淘宝网的数据和存储发展大致如下：</p>
<h2 id="集中式架构"><a href="#集中式架构" class="headerlink" title="集中式架构"></a>集中式架构</h2><p>缓存：所有数据都从数据库获取一方面速度比较慢，另一方面数据库承受不了这么大的访问量。一些被经常访问的数据直接从缓存中获取可以显著提高效率，减轻数据库的压力</p>
<p>读写分离：从原来的对一个数据库进行所有读写操作，拆分为一个主库和两个从库，并且读写分离，因为写操作比读操作更费时。主库只进行写操作，从库只进行读操作，主库进行写操作的同时，数据向从数据库同步</p>
<p>分库分表：查询速度与数据库容量成反比，采用多个数据库，对同一张表复制成多张，同时数据库路由的框架DBRoute，统一处理了数据的合并、排序、分页等操作，让程序员像使用一个数据库一样操作多个数据库里的数据</p>
<p>Mysql换成Oracle：选择Oracle的原因除了它容量大、稳定、安全、性能高之外，Oracle的性能和并发访问能力之所以如此强大，有一个关键性的设计——连接池，任何一个请求只需要从连接池中取得一个连接即可，用完后释放，这不需要频繁地创建和断开连接，而连接的创建和断开的开销是非常大的。Oracle从一开始运行在本机上，Nas上，到后来的小型机上，这些都能短时间提高存储容量，但Oracle、EMC、小型机都是很贵的，随着淘宝网的快速发展，钱钱终将不能解决问题，需要自主开发新的技术，一步一步地把IOE（IBM小型机、Oracle、EMC存储）</p>
<h2 id="分布式架构"><a href="#分布式架构" class="headerlink" title="分布式架构"></a>分布式架构</h2><p>淘宝分布式数据库TDDL：对上层来说，像查询一个数据库一样来查询数据，还要像查询一个数据库一样快；从集中式的Oracle切换到分布式的Mysql集群；用PC服务器替换小型机，小型机通过提高CPU，内存，磁盘等方式提高处理能力，价格昂贵，这种集中式架构的存储方式越来越不适应海量数据计算能力</p>
<p>分布式文件存储：淘宝的去IOE战略（IBM小型机、Oracle、EMC），使用适合淘宝使用的图片存储系统TFS</p>
<p>分布式缓存Tair：把常用的信息放在内存中，每次都从内存里取，性能会好很多。现在常用memcached、redis这种Key-Value缓存，只不过当时他们还没崭露头角</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/26/[编码]Java编码转换/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/26/[编码]Java编码转换/" itemprop="url">Java编码转换</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-26T12:48:00+08:00">
                2017-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编码/" itemprop="url" rel="index">
                    <span itemprop="name">编码</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先要注意，<strong>字符串在java内存中总是按unicode编码</strong></p>
<h2 id="getBytes-charset"><a href="#getBytes-charset" class="headerlink" title="getBytes(charset)"></a>getBytes(charset)</h2><p>Java中个 <strong>getBytes(charset)</strong> 函数的作用是将字符串所表示的是字符按照charset编码，并以字节表示</p>
<p>比如”中文”，在Java内存中用unicode编码，表示为0x4E2D 0x6587</p>
<p><img src="http://i.imgur.com/6Maz7lJ.png" alt=""></p>
<p>如果charset为”gbk”，则被编码为0xD6D0 0xCEC4</p>
<p><img src="http://i.imgur.com/MdevX2J.png" alt=""></p>
<p>如果charset为”utf-8”，则被编码为0xE4B8AD 0xE69687 </p>
<p><img src="http://i.imgur.com/IEZP1tV.png" alt=""></p>
<p><strong>如果是charset为”iso-8859-1”，由于无法编码(不能存储中文)，最后返回0x3F 0x3F，即？？</strong></p>
<p><img src="http://i.imgur.com/zUOwsyX.png" alt=""></p>
<p>如果包含英文字幕和中文字幕，如”a中国”，看一下<strong>不同编码英文、中文所占的字节数</strong></p>
<p>在Java内存中用unicode编码，每个字符都编码为两个字节，占的位置一样大，长度为3<br>用gbk编码英文占1个字节，中文占两个字节<br>用utf8编码英文占1个字节，中文占3个字节<br>用iso885901编码英文占1个字节，不能存储中文</p>
<p><img src="http://i.imgur.com/Wtw98Er.png" alt=""></p>
<h2 id="new-String-charset"><a href="#new-String-charset" class="headerlink" title="new String(charset)"></a>new String(charset)</h2><p>这是java字符串处理的另一个标准函数，和上一个函数的作用相反，<strong>将字节数组按照charset编码进行组合识别</strong>，最后转换为unicode存储。参考上述getBytes的例子，”gbk” 和”utf8”都可以得出正确的结果”4e2d 6587”，但iso8859-1最后变成了”003f 003f”（两个问号）。 </p>
<p>因为utf8可以用来表示/编码所有字符，所以new String( str.getBytes( “utf8” ), “utf8” ) === str，即完全可逆。 </p>
<pre><code>String a = &quot;中文&quot;;
byte[] gbk = a.getBytes(&quot;gbk&quot;);
byte[] utf8 = a.getBytes(&quot;utf-8&quot;);
byte[] iso8859_1 = a.getBytes(&quot;iso-8859-1&quot;);

System.out.println(new String(gbk,&quot;gbk&quot;));
System.out.println(new String(utf8,&quot;utf-8&quot;));
System.out.println(new String(iso8859_1,&quot;iso-8859-1&quot;));
</code></pre><p>输出</p>
<pre><code>中文
中文
??
</code></pre><h2 id="使用ISO-8859-1存储中文"><a href="#使用ISO-8859-1存储中文" class="headerlink" title="使用ISO-8859-1存储中文"></a><font color="red">使用ISO-8859-1存储中文</font></h2><p><a href="http://blog.chinaunix.net/uid-26808060-id-5692454.html" target="_blank" rel="external">http://blog.chinaunix.net/uid-26808060-id-5692454.html</a></p>
<p>在以上例子中，尝试将中文字符使用iso-8859-1编码，字节序都是0xFF，再用iso-8859-1解码后会得到？？，这是因为iso-8859-1是单字节编码，不能直接存储中文</p>
<p>在网络传输或其它应用中常常有统一的中间件，因此需要把其它类型的数据转换为中间件的类型。如在Java Web中，浏览器将编码后的字节流发送给Tomcat，在tomcat内部编码转换，并处理后，然后发送给接收端。<strong>这时候如果采用不同的编码可能会出现未成预料的问题，如乱码</strong></p>
<p><strong>案例1：</strong></p>
<p>我们用socket传输String类型的数据时，<strong>全部都统一为UTF-8编码</strong>，这样比较可以避免一个”中文乱码”的问题，这也是<strong>最推荐的解决中文乱码的方式。</strong></p>
<pre><code>//发送端，socket发送
String sendString = &quot;北京&quot;;
System.out.println(&quot;发送数据:&quot; + sendString);
byte[] sendBytes = sendString.getBytes(&quot;UTF-8&quot;);

//接受端，socket接收
String recString = new String(sendBytes, &quot;UTF-8&quot;);
System.out.println(&quot;接收数据:&quot; + recString);
</code></pre><p><strong>案例2</strong></p>
<p>但是想要发送的数据本身就是byte[]类型的。如果将其通过UTF-8编码转换为中间件String类型就会出现问题，（解码）如：</p>
<p><img src="http://i.imgur.com/ibOwYKn.png" alt=""></p>
<p><strong>需要采用单字节的编码方式进行转换：</strong></p>
<p>String sendString=new String(  bytes ,”UTF-8”); 改为 String sendString=new String(  bytes , “ISO-8859-1” );</p>
<p>byte[] Mybytes=isoString.getBytes(“UTF8”); 改为 byte[] Mybytes=isoString.getBytes(  “ISO-8859-1” );</p>
<p>这样所需要的字节就有恢复了</p>
<pre><code>//发送端
byte[] bytes = new byte[]{50, 0, -1, 28, -24};
String sendString = new String(bytes, &quot;iso-8859-1&quot;);
byte[] sendBytes = sendString.getBytes(&quot;UTF8&quot;);
//接收端
String recString = new String(sendBytes, &quot;UTF-8&quot;);
byte[] Mybytes = recString.getBytes(&quot;iso-8859-1&quot;);//发送的时候用iso-8859-1编码，解码是反过程
</code></pre><p>sendString显示的是拉丁字符，是iso-8859-1单字节解码后的结果</p>
<h2 id="避免中文乱码及乱码产生的原因★★★"><a href="#避免中文乱码及乱码产生的原因★★★" class="headerlink" title="避免中文乱码及乱码产生的原因★★★"></a>避免中文乱码及乱码产生的原因★★★</h2><p>1、最简单避免中文乱码的方式是统一编码，<strong>推荐整个系统中采用统一的utf-8编码方式</strong><br>2、编码、解码的字符集不一致会出现乱码，如采用utf-8编码，但是用gbk解码，则会产生乱码，如下：</p>
<pre><code>String str = &quot;上海&quot;;
byte[] b = str.getBytes(&quot;utf-8&quot;);
String s = new String(b,&quot;gbk&quot;);
System.out.println(s);//输出结果：涓婃捣
</code></pre><p><strong>而且产生乱码不能恢复到正确的字符：</strong></p>
<p><img src="http://i.imgur.com/jcha13T.png" alt=""></p>
<p>如”上”先用utf-8编码，再用gbk解码，在用gbk编码，字节序列b和gbk不同，说明由于不同编码长度不同，<strong>产生的中文乱码不可恢复</strong></p>
<font color="red"><strong>3、ISO8859-1的中文乱码</strong></font>


<p>1、出现？？</p>
<pre><code>String send = &quot;上海&quot;;
byte[] t = send.getBytes(&quot;iso-8859-1&quot;);
String recv = new String(t,&quot;iso-8859-1&quot;);
</code></pre><p>原因是<strong>正确接收到中文字符</strong>，但在存储的时候编码成iso-8859-1，此时返回的字节都是0x3F，再次用iso-8859-1（不管用什么编码，如utf-8）解码出来的时候都出现？？。<strong>一般出现？？，都是因为字符是中文，调用了byte[] t = send.getBytes(“iso-8859-1”);语句，乱码无法恢复</strong></p>
<p>2、出现拉丁乱码ä¸æµ·，将接收到的字符按照iso-8859-1编码得到字节序，<strong>即为原来utf-8编码后的正确字节</strong>，再进行utf-8解码即可（gbk同理）。<strong>如果出现拉丁乱码，乱码可以恢复，先用拉丁编码，在用正确的字符集解码</strong></p>
<pre><code>String str = &quot;上海&quot;;
byte[] b = str.getBytes(&quot;utf-8&quot;);
System.out.println(&quot;汉字：&quot; + str + &quot;utf-8编码形式：&quot; + Arrays.toString(b));
String s = new String(b, &quot;iso8859-1&quot;);
System.out.println(&quot;与之对应的iso8859-1解码形式：&quot; + s);

byte[] b1 = s.getBytes(&quot;iso8859-1&quot;);
System.out.println(s + &quot;与之对应的iso8859-1编码形式：&quot; + Arrays.toString(b1));
String s1 = new String(b1, &quot;utf-8&quot;);
System.out.println(&quot;解析后：&quot;+ s1);
</code></pre><p>结果：</p>
<pre><code>汉字：上海utf-8编码形式：[-28, -72, -118, -26, -75, -73]
与之对应的iso8859-1解码形式：ä¸æµ·
ä¸æµ·与之对应的iso8859-1编码形式：[-28, -72, -118, -26, -75, -73]
解析后：上海
</code></pre><p>3、出现汉字的乱码：中文经过utf-8编码后，再进行iso-8809-1编码，最后用gbk解码。<strong>产生原因是发送端、接收端编解码方式不一致</strong>，在字节流没有差错的情况下可以恢复</p>
<pre><code>//发送
String str = &quot;上海&quot;;
byte[] b = str.getBytes(&quot;utf-8&quot;);
System.out.println(&quot;汉字：&quot; + str + &quot;utf-8编码形式：&quot; + Arrays.toString(b));
//中间件
String s = new String(b, &quot;iso8859-1&quot;);
System.out.println(&quot;与之对应的iso8859-1解码形式：&quot; + s);
byte[] b1 = s.getBytes(&quot;iso8859-1&quot;);
System.out.println(s + &quot;与之对应的iso8859-1编码形式：&quot; + Arrays.toString(b1));
//接收
String s1 = new String(b1, &quot;gbk&quot;);
System.out.println(&quot;发送接收端编码不一致，解析错误结果：&quot;+ s1);
String s2 = new String(b1, &quot;utf-8&quot;);
System.out.println(&quot;发送接收端编码不一致，解析错误结果：&quot;+ s2);
</code></pre><p>结果：</p>
<pre><code>汉字：上海utf-8编码形式：[-28, -72, -118, -26, -75, -73]
与之对应的iso8859-1解码形式：ä¸æµ·
ä¸æµ·与之对应的iso8859-1编码形式：[-28, -72, -118, -26, -75, -73]
发送接收端编码不一致，解析错误结果：涓婃捣
发送接收端编码不一致，解析错误结果：上海
</code></pre><p>4、iso-8809-1在中间件中使用，传送中文字符，或传送字节</p>
<p>1、传送中文</p>
<p>发送的中英文字符经过<strong>中文编码</strong>后变成字节流发送到网络，<strong>中间件采用ISO-8859-1编码</strong>，接收端和发送端采用<strong>统一的编码</strong>，能够正确解码</p>
<pre><code>//发送
String str = &quot;上海&quot;;
byte[] b = str.getBytes(&quot;utf-8&quot;);
System.out.println(&quot;发送：&quot; + str + &quot;utf-8编码形式：&quot; + Arrays.toString(b));
//中间件
String s = new String(b, &quot;iso8859-1&quot;);
System.out.println(&quot;与之对应的iso8859-1解码形式：&quot; + s);
byte[] b1 = s.getBytes(&quot;iso8859-1&quot;);
System.out.println(s + &quot;与之对应的iso8859-1编码形式：&quot; + Arrays.toString(b1));
//接收
String s1 = new String(b1, &quot;utf-8&quot;);
System.out.println(&quot;接收：&quot;+ s1);
</code></pre><p>结果：</p>
<pre><code>发送：上海utf-8编码形式：[-28, -72, -118, -26, -75, -73]
与之对应的iso8859-1解码形式：ä¸æµ·
ä¸æµ·与之对应的iso8859-1编码形式：[-28, -72, -118, -26, -75, -73]
接收：上海
</code></pre><p>2、传送字节</p>
<p>如果需要传送字节，在发送端利用iso-8859-1解码，获得字符串。<strong>问题转换为如何正确传输该字符串</strong>，此时可以将字符串用utf-8编码发送字节流，接收端用utf-8解码得到字符串。字符串正确传递后，在用iso-8859-1解码即能获得正确的字节</p>
<p>如果只有发送端和接收端：</p>
<pre><code>//发送端
byte[] bytes = new byte[]{50, 0, -1, 28, -24};
String sendString = new String(bytes, &quot;iso-8859-1&quot;);
byte[] sendBytes = sendString.getBytes(&quot;UTF8&quot;);
//接收端
String recString = new String(sendBytes, &quot;UTF-8&quot;);
byte[] Mybytes = recString.getBytes(&quot;iso-8859-1&quot;);
</code></pre><p>如果考虑了中间件，代码如下：</p>
<pre><code>//发送端
byte[] bytes = new byte[]{50, 0, -1, 28, -24};
System.out.println(&quot;传送的字节：&quot; + Arrays.toString(bytes));
String send = new String(bytes, &quot;iso-8859-1&quot;);//发送所需的字节流问题转化为发送该字节流使用iso-8859-1解码后的字符串
System.out.println(&quot;传送的字节经过iso-8859-1解码：&quot; + send);
byte[] send_bytes = send.getBytes(&quot;utf-8&quot;);
System.out.println(&quot;字符经过utf-8编码：&quot; + Arrays.toString(send_bytes));
//中间件
String t = new String(send_bytes, &quot;iso-8859-1&quot;);
System.out.println(&quot;中间件用iso-8859-1解码的字符：&quot; + t);
byte[] t_bytes = t.getBytes(&quot;iso-8859-1&quot;);
System.out.println(&quot;中间件用iso-8859-1编码的字节&quot; + Arrays.toString(t_bytes));
//接收端
String recv = new String(t_bytes, &quot;utf-8&quot;);//正确接收字符串
System.out.println(&quot;接收端用utf-8解码的字符：&quot; + recv);
byte[] recv_bytes = recv.getBytes(&quot;iso-8859-1&quot;);//获得原先所需的字节流
System.out.println(&quot;接收端恢复编码：&quot; + Arrays.toString(recv_bytes));
</code></pre><p>输出结果：</p>
<pre><code>传送的字节：[50, 0, -1, 28, -24]
传送的字节经过iso-8859-1解码：2 ÿè
字符经过utf-8编码：[50, 0, -61, -65, 28, -61, -88]
中间件用iso-8859-1解码的字符：2 Ã¿Ã¨
中间件用iso-8859-1编码的字节[50, 0, -61, -65, 28, -61, -88]
接收端用utf-8解码的字符：2 ÿè
接收端恢复编码：[50, 0, -1, 28, -24]
</code></pre><p>4、<strong>中间件采用iso-8859-1编码不会出现乱码</strong>，这也是许多软件都默认采用latin1作为编码的原因，如Tomcat默认是iso-8859-1编码，Mysql默认也是iso-8859-1编码</p>
<h2 id="Mysql-几个参数的意义"><a href="#Mysql-几个参数的意义" class="headerlink" title="Mysql 几个参数的意义"></a>Mysql 几个参数的意义</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/25/[Mysql]Mysql中文乱码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/25/[Mysql]Mysql中文乱码/" itemprop="url">Mysql中文乱码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-25T23:42:00+08:00">
                2017-02-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC?"></a>JDBC?</h2><p>JDBC获得数据库连接时写在URL上的?useUnicode=true&amp;characterEncoding=utf-8，作用是指定字符的编码和解码格式</p>
<p>例如：mysql数据库用的是gbk编码，而项目数据库用的是utf-8编码。这时候如果添加了useUnicode=true&amp;characterEncoding=UTF-8 ，那么作用有如下两个方面：</p>
<p>1、存数据时：</p>
<p>数据库在存放项目数据的时候会先用UTF-8格式将数据解码成字节码，然后再将解码后的字节码重新使用GBK编码存放到数据库中。</p>
<p>2、取数据时：</p>
<p>在从数据库中取数据的时候，数据库会先将数据库中的数据按GBK格式解码成字节码，然后再将解码后的字节码重新按UTF-8格式编码数据，最后再将数据返回给客户端。</p>
<h2 id="设置数据库字符集"><a href="#设置数据库字符集" class="headerlink" title="设置数据库字符集"></a>设置数据库字符集</h2><p>有时候程序操作Mysql数据库时会出现 “?????” 或者是其他中文乱码，在命令行中输入：</p>
<pre><code>show variables like &apos;character%&apos;;
</code></pre><p>可看到如下字符：</p>
<pre><code>character_set_client        latin1
character_set_connection    latin1
character_set_database      utf8
character_set_results       latin1
character_set_server        utf8
character_set_system        utf8
</code></pre><p>解决办法是，在连接数据库之后，读取数据之前，先执行一项查询”SET NAMES UTF8”</p>
<ul>
<li>在PHP里为 mysql_query(“SET NAMES UTF8”); </li>
<li>在JDBC或者Mybatis中使用查询SQL语句为 “SET NAMES UTF8”</li>
</ul>
<p>到MySQL命令行输入”SET NAMES UTF8;”，然后执行</p>
<pre><code>show variables like &apos;character%&apos;;
</code></pre><p>发现原来为latin1的那些量”character_set_client”、“character_set_connection”、<br>“character_set_results”的值全部变为utf8了，原来是这3个变量在捣蛋。</p>
<p>查阅手册，上面那句等于：</p>
<pre><code>SET character_set_client = utf8;     
SET character_set_connection = utf8; 
SET character_set_results = utf8;    
</code></pre><p>看看这3个变量的作用：</p>
<ul>
<li>信息输入路径：client→connection→server</li>
<li>信息输出路径：server→connection→results</li>
</ul>
<p>换句话说，每个路径要<strong>经过3次改变字符集编码</strong>。以出现乱码的输出为例，server里utf8的数据，传入connection转为latin1，传入results转为latin1，utf-8页面又把results转过来。<strong>如果两种字符集不兼容，比如latin1和utf8，转化过程就为不可逆的，破坏性的。</strong></p>
<p>但这里要声明一点，”SET NAMES UTF8”作用只是临时的，MySQL重启后就恢复默认了。</p>
<p>总结：为了让你的网页能在更多的服务器上正常地显示，还是加上”SET NAMES UTF8”吧，即使你现在没有加上这句也能正常访问。</p>
<p>从执行命令前后可知，set names gbk只可以修改character_set_client、character_set_connection、 character_set_results的编码方式，并且这种修改是窗口级别的，只针对本窗口有效，打开另外一个窗口修改无效。也可发现数据库底层的编码方式没有改变，插入数据后还是以utf8编码方式保持。</p>
<p><a href="http://blog.csdn.net/zsmj_2011/article/details/7943734" target="_blank" rel="external">http://blog.csdn.net/zsmj_2011/article/details/7943734</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/17/[Git]Git笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/17/[Git]Git笔记/" itemprop="url">Git笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-17T11:14:00+08:00">
                2017-02-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>git log -p FILEPATH 单文件的改动<br>git reset –hard commit_id 撤销摸个commit</p>
<p>git branch 查看本地分支<br>git branch xx 创建分支<br>git branch -d xx 删除分支<br>git checkout xx 切换分支<br>git branch -a 查看远程分支</p>
<p>git remote  -v 查看远程地址信息<br>git push origin :branch-name 删除远程分支</p>
<p>##中文乱码<br>git显示中文被转义<br><a href="http://mushanshitiancai.github.io/2016/03/18/linux/git%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/" target="_blank" rel="external">http://mushanshitiancai.github.io/2016/03/18/linux/git%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/15/[编码]字符编码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/15/[编码]字符编码/" itemprop="url">字符编码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-15T10:39:00+08:00">
                2017-02-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编码/" itemprop="url" rel="index">
                    <span itemprop="name">编码</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>各种字符集和编码详解<br><a href="http://blog.csdn.net/ancky/article/details/2034809" target="_blank" rel="external">http://blog.csdn.net/ancky/article/details/2034809</a><br>Java字符编码<br><a href="http://blog.csdn.net/xiongchao2011/article/details/7276834" target="_blank" rel="external">http://blog.csdn.net/xiongchao2011/article/details/7276834</a><br>★★★十分钟搞清字符集和字符编码<br><a href="http://cenalulu.github.io/linux/character-encoding/" target="_blank" rel="external">http://cenalulu.github.io/linux/character-encoding/</a></p>
<p>字符（英文、中文、符号、数字等）需要在计算机内存储，必须进行编码</p>
<h2 id="什么是字符集"><a href="#什么是字符集" class="headerlink" title="什么是字符集"></a>什么是字符集</h2><p>我们在计算机屏幕上看到的是<strong>实体化的文字</strong>，而在计算机存储介质中存放的实际是<strong>二进制的比特流</strong>。那么在这两者之间的<strong>转换规则就需要一个统一的标准</strong>，否则把我们的U盘插到老板的电脑上，文档就乱码了</p>
<p>于是为了实现转换标准，各种字符集标准就出现了。简单的说字符集就规定了<font color="red"><strong>某个文字对应的二进制数字存放方式（编码）和某串二进制数值代表了哪个文字（解码）的转换关系</strong></font></p>
<p><img src="http://i.imgur.com/roaSD4p.png" alt=""></p>
<h2 id="字符编码发展历史"><a href="#字符编码发展历史" class="headerlink" title="字符编码发展历史"></a>字符编码发展历史</h2><p><strong>ASCII</strong></p>
<p>最早的ASCII码用7个二进制表示（0x00 - 0x7F），能表示128个字符，足够表示英语及西欧语言</p>
<p><strong>iso8859-1（Latin-1）</strong></p>
<ul>
<li><strong>最优秀的扩展ASCII</strong>，8位长度（一个字节，范围从0x00 - 0xFF），能表示256个字符</li>
<li><strong>单字节编码</strong>，和计算机最基础的表示单位一致，在很多协议上，默认使用该编码。比如，虽然”中文”两个字不存在iso8859-1编码，以gb2312编码为例，应该是”d6d0 cec4”，<strong>一个汉字编码成两个字节</strong>，使用iso8859-1编码的时候则将它拆开为4个字节来表示：”d6 d0 ce c4”（事实上，在进行存储的时候，也是以字节为单位处理的）。而如果是UTF编码，则是6个字节”e4 b8 ad e6 96 87”，<strong>一个汉字编码成三个字节</strong>。很明显，这种表示方法还需要以另一种编码为基础。</li>
</ul>
<p><strong>GB码字符集，GB2312，GB12345-90，GBK字符集</strong></p>
<ul>
<li>双字节编码</li>
<li>GBK编码能够用来同时表示<strong>繁体字和简体字</strong>，而GB2312只能表示简体字，GBK是兼容gb2312编码的，是GB2312的扩展，共收录汉字21003个、符号883个</li>
</ul>
<p><strong>BIG5字符集</strong></p>
<p>是目前台湾、香港地区普遍使用的一种<strong>繁体汉字</strong>的编码标准，为统一繁体字编码，使用2个字节表示汉字，Big5字符集共收录13,053个中文字</p>
<p><strong>Unicode字符集（UCS）</strong></p>
<ul>
<li>各国文字、符号进行统一性编码，<strong>Unicode编码后占用的空间大小是一样的，都是两个字节</strong></li>
<li>定长编码便于计算机处理（注意GB2312/GBK不是定长编码），而<strong>unicode又可以用来表示所有字符</strong>，所以在很多软件内部是使用unicode编码来处理的，比如Java</li>
<li><strong>UNICODE字符集</strong>有多个编码方式，分别是UTF-8，UTF-16，UTF-32和UTF-7编码。</li>
</ul>
<p><strong>UTF-8</strong></p>
<ul>
<li>unicode对于英文字母也要用两个字节来表示，浪费空间，不利于传输和存储，因而产生了utf编码</li>
<li>UTF-8是不定长编码。<font color="red"><strong>一般来讲，英文字母都是用一个字节表示，而汉字使用三个字节</strong></font></li>
<li>虽然utf编码对汉字使用3个字节，但即使对于汉字网页，utf编码也会比unicode编码节省，因为<strong>网页中包含了很多的英文字符</strong></li>
</ul>
<p><strong>Base64</strong></p>
<ul>
<li>对内容进行简单加密，即一眼望去看不出内容即可，不需要进行复杂的加密</li>
<li>由于历史原因Email<strong>只被允许传送ASCII字符</strong>，即一个8位字节的低7位，这是产生Base64编码的主要原因</li>
<li>111111 x11 1111 x1111 11x111111</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/13/[Thrift]Thrift笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/13/[Thrift]Thrift笔记/" itemprop="url">Thrift笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-13T16:21:00+08:00">
                2017-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Thrift/" itemprop="url" rel="index">
                    <span itemprop="name">Thrift</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Thrift"><a href="#Thrift" class="headerlink" title="Thrift"></a>Thrift</h2><p><a href="http://www.ibm.com/developerworks/cn/java/j-lo-apachethrift/#ibm-pcon" target="_blank" rel="external">http://www.ibm.com/developerworks/cn/java/j-lo-apachethrift/#ibm-pcon</a><br>目前流行的服务调用方式有很多种，例如基于 SOAP 消息格式的 Web Service，基于 JSON 消息格式的 RESTful 服务等。<strong>其中所用到的数据传输方式包括 XML，JSON 等，然而 XML 相对体积太大，传输效率低，JSON 体积较小，新颖，但还不够完善</strong>。本文将介绍由 Facebook 开发的远程服务调用框架 Apache Thrift，它采用接口描述语言定义并创建服务，支持可扩展的跨语言服务开发，所包含的代码生成引擎可以在多种语言中，如 C++, Java, Python, PHP, Ruby, Erlang, Perl, Haskell, C#, Cocoa, Smalltalk 等创建高效的、无缝的服务，其传输数据采用二进制格式，相对 XML 和 JSON 体积更小，对于高并发、大数据量和多语言的环境更有优势</p>
<h3 id="Thrift流程"><a href="#Thrift流程" class="headerlink" title="Thrift流程"></a>Thrift流程</h3><p>1、使用 IDL 语法定义接口 Hello.thrift</p>
<pre><code>namespace java service.demo
service Hello{
    string helloString(1:string para)
}
</code></pre><p>service.demo：包名<br>Hello：生成的类名<br>helloString：定义的接口名</p>
<p>2、使用thrift编译器生成Java代码</p>
<p>命令：</p>
<pre><code>thrift -r --gen java tutorial.thrift
</code></pre><p>thrift编译器下载地址：</p>
<pre><code>http://www.apache.org/dyn/closer.cgi?path=/thrift/0.9.3/thrift-0.9.3.exe
</code></pre><p>3、生成对应语言的接口代码及服务调用的底层通信细节，生成的对应语言代码与编译器位于同一目录</p>
<pre><code>package service.demo;

class Hello{

    //生成的对应语言的接口
    public interface Iface {
        public String helloString(String para) throws org.apache.thrift.TException;
    }

    //###客户端调用逻辑
    public static class Client extends org.apache.thrift.TServiceClient implements Iface {
        ...
        //实现的接口方法
        public String helloString(String para) throws org.apache.thrift.TException
        {
            //向服务器发送请求方法+参数
            send_helloString(para);
            //接受服务器的请求
            return recv_helloString();
        }

        //发送请求方法+参数，其中helloString为调用服务器的方法名，args为方法参数
        public void send_helloString(String para) throws org.apache.thrift.TException
        {
            helloString_args args = new helloString_args();
            args.setPara(para);
            sendBase(&quot;helloString&quot;, args);
        }

        //接受服务器返回的结果
        public String recv_helloString() throws org.apache.thrift.TException
        {
            helloString_result result = new helloString_result();
            receiveBase(result, &quot;helloString&quot;);
            if (result.isSetSuccess()) {
                return result.success;
            }
            throw new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.MISSING_RESULT, &quot;helloString failed: unknown result&quot;);
        }
        ...
    }

}
//### 服务端处理逻辑
public static class Processor&lt;I extends Iface&gt; extends org.apache.thrift.TBaseProcessor&lt;I&gt; implements org.apache.thrift.TProcessor {

    private static &lt;I extends Iface&gt; Map&lt;String,  org.apache.thrift.ProcessFunction&lt;I, ? extends  org.apache.thrift.TBase&gt;&gt; getProcessMap(Map&lt;String,  org.apache.thrift.ProcessFunction&lt;I, ? extends  org.apache.thrift.TBase&gt;&gt; processMap) {
        processMap.put(&quot;helloString&quot;, new helloString());
        return processMap;
    }

        public static class helloString&lt;I extends Iface&gt; extends org.apache.thrift.ProcessFunction&lt;I, helloString_args&gt; {
        public helloString() {
        super(&quot;helloString&quot;);
    }

    public helloString_args getEmptyArgsInstance() {
        return new helloString_args();
    }

    protected boolean isOneway() {
        return false;
    }

    public helloString_result getResult(I iface, helloString_args args) throws org.apache.thrift.TException {
        helloString_result result = new helloString_result();
            result.success = iface.helloString(args.para);
            return result;
        }
    }

}
</code></pre><p>4、创建接口实现类</p>
<p>服务器创建接口实现类</p>
<pre><code>public HelloServiceImpl implements Hello.Iface{
    @Override
    public String helloString(String para) throws org.apache.thrift.TException{
        System.our.println(&quot;Hello&quot;);
    }
}
</code></pre><p>5、启动Thrift服务器，HelloServiceImpl 作为具体的处理器传递给 Thrift 服务器</p>
<pre><code>public class Server {
    /**
     * 启动 Thrift 服务器
     * @param args
     */
    public static void main(String[] args) throws TTransportException {
        try {
            //1、传输层，设置服务端口为 7911
            TServerSocket serverTransport = new TServerSocket(7911);
            //2、协议，工厂为 TBinaryProtocol.Factory
            TBinaryProtocol.Factory proFactory = new TBinaryProtocol.Factory();
            // 处理器
            TProcessor processor = new Hello.Processor(new HelloImpl());

            //3、服务端类型，关联端口、协议、处理器与 Hello 服务的实现
            TThreadPoolServer.Args tArgs = new TThreadPoolServer.Args(serverTransport);
            tArgs.processor(processor);
            tArgs.protocolFactory(proFactory);

            TServer server = new TThreadPoolServer(tArgs);
            System.out.println(&quot;Start server on port 7911...&quot;);
            server.serve();
        } catch (TTransportException e) {
            e.printStackTrace();
        }
    }
}
</code></pre><p>6、客户端连接到端口，发送请求调用方法，服务端响应结果，客户端接受结果</p>
<pre><code>public class Client {
    /**
     * 调用 Hello 服务
     *
     * @param args
     */
    public static void main(String[] args) {
        try {
            // 设置调用的服务地址为本地，端口为 7911
            TTransport transport = new TSocket(&quot;localhost&quot;, 7911);
            transport.open();
            // 设置传输协议为 TBinaryProtocol
            TProtocol protocol = new TBinaryProtocol(transport);
            //客户端调用
            Hello.Client client = new Hello.Client(protocol);
            // 调用服务的 helloVoid 方法
            System.out.println(client.helloString(&quot;客户端传入参数&quot;));
            transport.close();
        } catch (TTransportException e) {
            e.printStackTrace();
        } catch (TException e) {
            e.printStackTrace();
        }
    }
}
</code></pre><h3 id="Thrift架构"><a href="#Thrift架构" class="headerlink" title="Thrift架构"></a>Thrift架构</h3><p><img src="http://i.imgur.com/h1KGvdq.jpg" alt=""></p>
<p>如图所示，图中黄色部分是用户实现的业务逻辑，褐色部分是根据 Thrift 定义的服务接口描述文件生成的客户端和服务器端代码框架，红色部分是根据 Thrift 文件生成代码实现数据的读写操作。红色部分以下是 Thrift 的传输体系、协议以及底层 I/O 通信，使用 Thrift 可以很方便的定义一个服务并且选择不同的传输协议和传输层而不用重新生成代码。</p>
<p>Thrift 服务器包含用于绑定协议和传输层的基础架构，它提供阻塞、非阻塞、单线程和多线程的模式运行在服务器上，可以配合服务器 / 容器一起运行，可以和现有的 J2EE 服务器 /Web 容器无缝的结合。</p>
<p><img src="http://i.imgur.com/nZ4Aoap.png" alt=""></p>
<p>该图所示是 HelloServiceServer 启动的过程以及服务被客户端调用时，服务器的响应过程。从图中我们可以看到，程序调用了 TThreadPoolServer 的 serve 方法后，server 进入阻塞监听状态，其阻塞在 TServerSocket 的 accept 方法上。当接收到来自客户端的消息后，服务器发起一个新线程处理这个消息请求，原线程再次进入阻塞状态。在新线程中，服务器通过 TBinaryProtocol 协议读取消息内容，调用 HelloServiceImpl 的 helloVoid 方法，并将结果写入 helloVoid_result 中传回客户端。</p>
<p><img src="http://i.imgur.com/KqC4Vo6.png" alt=""></p>
<p>该图所示是 HelloServiceClient 调用服务的过程以及接收到服务器端的返回值后处理结果的过程。从图中我们可以看到，程序调用了 Hello.Client 的 helloVoid 方法，在 helloVoid 方法中，通过 send_helloVoid 方法发送对服务的调用请求，通过 recv_helloVoid 方法接收服务处理请求后返回的结果。</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>Thrift 脚本可定义的数据类型包括以下几种类型：</p>
<pre><code>基本类型：
bool：布尔值，true 或 false，对应 Java 的 boolean
byte：8 位有符号整数，对应 Java 的 byte
i16：16 位有符号整数，对应 Java 的 short
i32：32 位有符号整数，对应 Java 的 int
i64：64 位有符号整数，对应 Java 的 long
double：64 位浮点数，对应 Java 的 double
string：未知编码文本或二进制字符串，对应 Java 的 String
结构体类型：
struct：定义公共的对象，类似于 C 语言中的结构体定义，在 Java 中是一个 JavaBean
容器类型：
list：对应 Java 的 ArrayList
set：对应 Java 的 HashSet
map：对应 Java 的 HashMap
异常类型：
exception：对应 Java 的 Exception
服务类型：
service：对应服务的类
</code></pre><h3 id="★协议"><a href="#★协议" class="headerlink" title="★协议"></a>★协议</h3><p>Thrift 可以让用户选择客户端与服务端之间传输通信协议的类别，在传输协议上总体划分为<strong>文本 (text)</strong> 和<strong>二进制 (binary)</strong> 传输协议，为节约带宽，提高传输效率，一般情况下使用二进制类型的传输协议为多数，有时还会使用基于文本类型的协议，这需要根据项目 / 产品中的实际需求。常用协议有以下几种：</p>
<ul>
<li><p>TBinaryProtocol —— 二进制编码格式进行数据传输</p>
<pre><code>// 设置协议工厂为 TBinaryProtocol.Factory
TBinaryProtocol.Factory proFactory = new TBinaryProtocol.Factory();
</code></pre></li>
<li><p>TCompactProtocol —— 高效率的、密集的二进制编码格式进行数据传输，构建 TCompactProtocol 协议的服务器和客户端只需替换案例中 TBinaryProtocol 协议部分即可</p>
<pre><code>TCompactProtocol.Factory proFactory = new TCompactProtocol.Factory();
</code></pre></li>
<li><p>TJSONProtocol —— 使用 JSON 的数据编码协议进行数据传输，构建 TJSONProtocol 协议的服务器和客户端只需替换案例中 TBinaryProtocol 协议部分即可</p>
<pre><code>TJSONProtocol.Factory proFactory = new TJSONProtocol.Factory();
</code></pre></li>
<li><p>TSimpleJSONProtocol —— 只提供 JSON 只写的协议，适用于通过脚本语言解析</p>
</li>
</ul>
<h3 id="★传输层"><a href="#★传输层" class="headerlink" title="★传输层"></a>★传输层</h3><p>常用的传输层有以下几种：</p>
<ul>
<li>TSocket —— 使用阻塞式 I/O 进行传输，是最常见的模式（案例）</li>
</ul>
<pre><code>//服务端
TServerSocket serverTransport = new TServerSocket(7911);
//客户端
TTransport transport = new TSocket(&quot;localhost&quot;, 7911);
</code></pre><ul>
<li>TFramedTransport —— 使用非阻塞方式，按块的大小进行传输，类似于 Java 中的 NIO，若使用 TFramedTransport 传输层，其<strong>服务器必须修改为非阻塞的服务类型</strong>，<strong>客户端只需替换案例中 TTransport 部分</strong></li>
</ul>
<p>服务器</p>
<pre><code>TNonblockingServerTransport serverTransport; 
serverTransport = new TNonblockingServerSocket(10005); 
Hello.Processor processor = new Hello.Processor(new HelloServiceImpl()); 
TServer server = new TNonblockingServer(processor, serverTransport); 
System.out.println(&quot;Start server on port 10005 ...&quot;); 
server.serve();
</code></pre><p>客户端</p>
<pre><code>TTransport transport = new TFramedTransport(new TSocket(&quot;localhost&quot;, 10005));
</code></pre><ul>
<li>TNonblockingTransport —— 使用非阻塞方式，用于构建异步客户端<br>使用方法请参考 Thrift 异步客户端构建</li>
</ul>
<h3 id="★服务端类型"><a href="#★服务端类型" class="headerlink" title="★服务端类型"></a>★服务端类型</h3><p>常见的服务端类型有以下几种：</p>
<ul>
<li>TSimpleServer —— 单线程服务器端使用标准的阻塞式 I/O</li>
</ul>
<pre><code>TServerSocket serverTransport = new TServerSocket(7911); 
TProcessor processor = new Hello.Processor(new HelloServiceImpl()); 
TServer server = new TSimpleServer(processor, serverTransport); 
System.out.println(&quot;Start server on port 7911...&quot;); 
server.serve();
</code></pre><ul>
<li>TThreadPoolServer —— 多线程服务器端使用标准的阻塞式 I/O（案例）</li>
</ul>
<pre><code>// 设置服务端口为 7911
TServerSocket serverTransport = new TServerSocket(7911);
// 设置协议工厂为 TBinaryProtocol.Factory
TBinaryProtocol.Factory proFactory = new TBinaryProtocol.Factory();
// 处理器
TProcessor processor = new Hello.Processor(new HelloImpl());

//关联端口、协议、处理器与 Hello 服务的实现
TThreadPoolServer.Args tArgs = new TThreadPoolServer.Args(serverTransport);
tArgs.processor(processor);
tArgs.protocolFactory(proFactory);

TServer server = new TThreadPoolServer(tArgs);
System.out.println(&quot;Start server on port 7911...&quot;);
server.serve();
</code></pre><ul>
<li>TNonblockingServer —— 多线程服务器端使用非阻塞式 I/O<br>使用方法请参考 Thrift 异步客户端构建</li>
</ul>
<h3 id="Thrift-异步客户端构建"><a href="#Thrift-异步客户端构建" class="headerlink" title="Thrift 异步客户端构建"></a>Thrift 异步客户端构建</h3><p>Thrift 提供非阻塞的调用方式，可构建异步客户端。在这种方式中，Thrift 提供了新的类 TAsyncClientManager 用于管理客户端的请求，在一个线程上追踪请求和响应，同时通过接口 AsyncClient 传递标准的参数和 callback 对象，服务调用完成后，callback 提供了处理调用结果和异常的方法。<br><strong>首先我们看 callback 的实现：</strong></p>
<pre><code>package service.callback; 
import org.apache.thrift.async.AsyncMethodCallback; 

public class MethodCallback implements AsyncMethodCallback { 
    Object response = null; 

    public Object getResult() { 
        // 返回结果值
        return this.response; 
    } 

    // 处理服务返回的结果值
    @Override 
    public void onComplete(Object response) { 
        this.response = response; 
    } 
    // 处理调用服务过程中出现的异常
    @Override 
    public void onError(Throwable throwable) { 

    } 
}
</code></pre><p>如代码所示，onComplete 方法接收服务处理后的结果，此处我们将结果 response 直接赋值给 callback 的私有属性 response。onError 方法接收服务处理过程中抛出的异常，此处未对异常进行处理。</p>
<p><strong>创建非阻塞服务器端实现代码</strong>，将 HelloServiceImpl 作为具体的处理器传递给异步 Thrift 服务器，代码如下：</p>
<pre><code>package service.server; 
import org.apache.thrift.server.TNonblockingServer; 
import org.apache.thrift.server.TServer; 
import org.apache.thrift.transport.TNonblockingServerSocket; 
import org.apache.thrift.transport.TNonblockingServerTransport; 
import org.apache.thrift.transport.TTransportException; 
import service.demo.Hello; 
import service.demo.HelloServiceImpl; 

public class HelloServiceAsyncServer { 
    /** 
     * 启动 Thrift 异步服务器
     * @param args 
     */ 
    public static void main(String[] args) { 
        TNonblockingServerTransport serverTransport; 
        try { 
            serverTransport = new TNonblockingServerSocket(10005); 
            Hello.Processor processor = new Hello.Processor( 
                    new HelloServiceImpl()); 
            TServer server = new TNonblockingServer(processor, serverTransport); 
            System.out.println(&quot;Start server on port 10005 ...&quot;); 
            server.serve(); 
        } catch (TTransportException e) { 
            e.printStackTrace(); 
        } 
    } 
}
</code></pre><p>HelloServiceAsyncServer 通过 java.nio.channels.ServerSocketChannel 创建非阻塞的服务器端等待客户端的连接。</p>
<p><strong>创建异步客户端实现代码</strong>，调用 Hello.AsyncClient 访问服务端的逻辑实现，将 MethodCallback 对象作为参数传入调用方法中，代码如下：</p>
<pre><code>package service.client; 
import java.io.IOException; 
import org.apache.thrift.async.AsyncMethodCallback; 
import org.apache.thrift.async.TAsyncClientManager; 
import org.apache.thrift.protocol.TBinaryProtocol; 
import org.apache.thrift.protocol.TProtocolFactory; 
import org.apache.thrift.transport.TNonblockingSocket; 
import org.apache.thrift.transport.TNonblockingTransport; 
import service.callback.MethodCallback; 
import service.demo.Hello; 

public class HelloServiceAsyncClient { 
    /** 
     * 调用 Hello 服务
     * @param args 
     */ 
    public static void main(String[] args) throws Exception { 
        try { 
            TAsyncClientManager clientManager = new TAsyncClientManager(); 
            TNonblockingTransport transport = new TNonblockingSocket( 
                    &quot;localhost&quot;, 10005); 
            TProtocolFactory protocol = new TBinaryProtocol.Factory(); 
            Hello.AsyncClient asyncClient = new Hello.AsyncClient(protocol, 
                    clientManager, transport); 
            System.out.println(&quot;Client calls .....&quot;); 
            MethodCallback callBack = new MethodCallback(); 
            asyncClient.helloString(&quot;Hello World&quot;, callBack); 
            Object res = callBack.getResult(); 
            while (res == null) { 
                res = callBack.getResult(); 
            } 
            System.out.println(((Hello.AsyncClient.helloString_call) res) 
                    .getResult()); 
        } catch (IOException e) { 
            e.printStackTrace(); 
        } 
    } 
}
</code></pre><p>HelloServiceAsyncClient 通过 java.nio.channels.Socketchannel 创建异步客户端与服务器建立连接。在本文中异步客户端通过以下的循环代码实现了同步效果，读者可去除这部分代码后再运行对比。</p>
<p>异步客户端实现同步效果代码段</p>
<pre><code>Object res = callBack.getResult();
// 等待服务调用后的返回结果
while (res == null) {
   res = callBack.getResult();
}
</code></pre><p>我们可以构建一个 TNonblockingServer 服务类型的服务端，在客户端构建一个 TFramedTransport 传输层的同步客户端和一个 TNonblockingTransport 传输层的异步客户端，那么一个服务就可以通过一个 socket 端口提供两种不同的调用方式。有兴趣的读者可以尝试一下。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/13/[SSM]XML CDATA的作用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/13/[SSM]XML CDATA的作用/" itemprop="url">XML CDATA的作用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-13T09:54:00+08:00">
                2017-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SSM/" itemprop="url" rel="index">
                    <span itemprop="name">SSM</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.cnblogs.com/myparamita/archive/2008/12/27/1363626.html" target="_blank" rel="external">http://www.cnblogs.com/myparamita/archive/2008/12/27/1363626.html</a></p>
<p>XML文件中的一些<strong>特殊符号</strong>，例如：”&lt;”、”&gt;”、”/“、”？”等，会破坏了XML结构</p>
<p>有两种方式解决：</p>
<ul>
<li>转义字符</li>
<li>CDATA部件</li>
</ul>
<h2 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h2><p>如果在XML文档中使用类似”&lt;”的字符, 那么解析器将会出现错误，因为解析器会认为这是一个新元素的开始。所以不应该象下面那样书写代码:</p>
<pre><code>&lt;message&gt;if salary &lt; 1000 then&lt;/message&gt; 
</code></pre><p>为了避免出现这种情况，必须将字符”&lt;”转换成实体，象下面这样:</p>
<pre><code>&lt;message&gt;if salary &amp;lt; 1000 then&lt;/message&gt; 
</code></pre><p>下面是五个在XML文档中预定义好的实体:</p>
<pre><code>&amp;lt; &lt; 小于号 
&amp;gt; &gt; 大于号 
&amp;amp; &amp; 和 
&amp;apos; &apos; 单引号 
&amp;quot; &quot; 双引号 
</code></pre><p>实体必须以符号”&amp;”开头，以符号”;”结尾。 </p>
<p>注意: 只有”&lt;” 字符和”&amp;”字符对于XML来说是严格禁止使用的。剩下的都是合法的，为了减少出错，使用实体是一个好习惯。</p>
<h2 id="CDATA"><a href="#CDATA" class="headerlink" title="CDATA"></a>CDATA</h2><p>在CDATA内部的所有内容都会被解析器忽略。</p>
<p>如果文本包含了很多的”&lt;”字符和”&amp;”字符——就象程序代码一样，那么最好把他们都放到CDATA部件中。</p>
<p>一个 CDATA 部件以”&lt;![CDATA[“标记开始，以”]]&gt;”标记结束:</p>
<pre><code>&lt;script&gt;
    &lt;![CDATA[
        function matchwo(a,b)
        {
            if (a &lt; b &amp;&amp; a &lt; 0) then
            {
                return 1
            }
            else
            {
                return 0
            }
        }
    ]]&gt;
&lt;/script&gt; 
</code></pre><p>在前面的例子中，所有在CDATA部件之间的文本都会被解析器忽略。</p>
<p>CDATA注意事项:<br>CDATA部件之间不能再包含CDATA部件（不能嵌套）。如果CDATA部件包含了字符”]]&gt;” 或者”&lt;![CDATA[“ ，将很有可能出错哦。</p>
<p>同样要注意在字符串”]]&gt;”之间没有空格或者换行符。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/02/09/[Maven]Maven聚合与继承/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/09/[Maven]Maven聚合与继承/" itemprop="url">Maven聚合与继承</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-09T22:13:00+08:00">
                2017-02-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Maven/" itemprop="url" rel="index">
                    <span itemprop="name">Maven</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h2><p>什么是聚合？聚合就是<strong>把多个模块或项目聚合到一起</strong>，简单统一的完成编译等工作</p>
<p>为了能够使用一条命令就能构建 account-email 和 account-persist两个模块，我们需要建立一个额外的名为 account-aggregator 的模块，然后通过该模块构建整个项目的所有模块。 account-aggregator本身也是个 Maven 项目，它的 POM如下</p>
<pre>
&lt;project>  
    &lt;modelVersion>4.0.0&lt;/modelVersion>  
    &lt;groupId>com.juvenxu.mvnbook.account&lt;/groupId>  
    &lt;artifactId>account-aggregator&lt;/artifactId>  
    &lt;version>1.0.0-SNAPSHOT&lt;/version>  
    <font color="red">&lt;packaging> pom &lt;/packaging>  </font>
    &lt;name>Account Aggregator&lt;/name>  
     &lt;modules>  
        &lt;module>account-email&lt;/module>  
        &lt;module>account-persist&lt;/module>  
     &lt;/modules>  
&lt;/project> 
</pre>

<p>注意：packaging的类型为pom ，module的值是一个以当前POM为主目录的相对路径。</p>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>在POM中申明一些配置供子POM继承，以实现”一处申明，多处使用的”目的</p>
<p>在account-aggregator下创建一个account-parent的子目录，然后在该子目录下创建除account-aggregator模块之外的模块的父模块。为此在该子目录下创建一个pom.xml文件如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  
xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;  
        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; 

        &lt;groupId&gt;com.juvenxu.mvnbook.account&lt;/groupId&gt;  
        &lt;artifactId&gt;account-parent&lt;/artifactId&gt;  
        &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;  

        &lt;packaging&gt;pom&lt;/packaging&gt;  

        &lt;properties&gt;
                &lt;springframework.version&gt;2.5.6&lt;/springframework.version&gt;
        &lt;/properties&gt;

        &lt;dependencyManagement&gt;
                &lt;dependencies&gt;
                       &lt;dependency&gt;
                            &lt;groupId&gt;org.springframework &lt;/groupId&gt;
                            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
                            &lt;version&gt;${springframework.version}&lt;/version&gt;
                       &lt;/dependency&gt;

                       ......

                &lt;/dependencies&gt;
        &lt;/dependencyManagement&gt;
&lt;/project&gt; 
</code></pre><p>需要注意的是它的packaging的值必须为pom，这一点与模块聚合一样，作为父模块的POM，其打包类型也必须为pom。由于父模块只是为了消除配置的重复，因此也就<strong>不需要src/main/java等目录了</strong></p>
<p>有了父模块就让其他子模块来继承它，修改account-email的pom文件如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  
xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;  
&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; 
        &lt;parent&gt;
            &lt;groupId&gt;com.juvenxu.mvnbook.account&lt;/groupId&gt;  
            &lt;artifactId&gt;account-parent&lt;/artifactId&gt;  
            &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;  
            &lt;relativePath&gt;../account-parent/pom.xml&lt;/relativePath&gt;  
        &lt;/parent&gt; 
        &lt;artifactId&gt;account-email&lt;/artifactId&gt; 
        &lt;name&gt;Account Email&lt;/name&gt; 

        &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
                &lt;/dependency&gt;

                ......

        &lt;/dependencies&gt;

        &lt;build&gt;
                &lt;plugins&gt;
                    ......
                &lt;/plugins&gt;
        &lt;/build&gt;

&lt;/project&gt;
</code></pre><p><strong>只配置了groupId和artifactId,省去了version</strong>，如果父模块配置了依赖的scope也是可以省略的。这些信息可以省略是因为account-email继承了account-parent中的dependencyManagement配置，完整的依赖声明已经包含在父POM中了，子模块只需简单的配置groupId和artifactId。</p>
<p>使用这种以来管理机制虽然不能减少太多的配置项，但是经过别人实践后强烈推荐的方法。如果子模块不声明依赖的使用，即使该依赖已经在父POM文件dependencyManagement中声明了，也不会产生任何实际的效果。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/01/18/[mybatis]通用mapper/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/18/[mybatis]通用mapper/" itemprop="url">通用mapper</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-18T09:23:00+08:00">
                2017-01-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>不是表中字段的属性必须加 @Transient 注解</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/01/17/[Servlet]JSTL常用语法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/17/[Servlet]JSTL常用语法/" itemprop="url">JSTL常用语法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-17T09:30:00+08:00">
                2017-01-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Servlet/" itemprop="url" rel="index">
                    <span itemprop="name">Servlet</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Maven依赖"><a href="#Maven依赖" class="headerlink" title="Maven依赖"></a>Maven依赖</h2><pre><code>&lt;!--JSP相关--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;jstl&lt;/groupId&gt;
    &lt;artifactId&gt;jstl&lt;/artifactId&gt;
    &lt;version&gt;1.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre><h2 id="JSP头"><a href="#JSP头" class="headerlink" title="JSP头"></a>JSP头</h2><pre><code>&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;
&lt;%@ taglib prefix=&quot;fmt&quot; uri=&quot;http://java.sun.com/jstl/fmt_rt&quot;%&gt;
</code></pre><h2 id="常用标签"><a href="#常用标签" class="headerlink" title="常用标签"></a>常用标签</h2><p><strong>PS：传入的对象除了一般的POJO对象，还可以是JSONObject和JSONArray</strong></p>
<p>&lt;c:if&gt; 标签</p>
<pre><code>&lt;!-- 判断集合不为空 --&gt;
&lt;c:if test=&quot;${!empty list}&quot;&gt;
    ...
&lt;/c:if&gt;

&lt;!-- 元素判断 --&gt;
&lt;c:if test=&quot;${salary &gt; 2000}&quot;&gt;
   &lt;p&gt;我的工资为: &lt;c:out value=&quot;${salary}&quot;/&gt;&lt;p&gt;
&lt;/c:if&gt;
</code></pre><p>&lt;c:forEach&gt; 标签</p>
<pre>
&lt;c:forEach items="${list}" var="o" varStatus="status">
    &lt;!-- 下标 -->
    订单[${status.index + 1}] 的订单号是： ${o.orderNo}
&lt;/c:forEach>
</pre>

<p>forEach嵌套</p>
<pre><code>&lt;%
    Map&lt;String, String[]&gt; bigCities = new HashMap&lt;String,String[]&gt;();
    bigCities.put(&quot;Australia&quot;,new String[]{&quot;Sydney&quot;,&quot;Melbourne&quot;,&quot;Perth&quot;});
    bigCities.put(&quot;New Zealand&quot;,new String[]{&quot;Auckland&quot;,&quot;Christchurch&quot;,&quot;Wellington&quot;});
    bigCities.put(&quot;Indonesia&quot;,new String[]{&quot;Jakarta&quot;,&quot;Surabaya&quot;,&quot;Medan&quot;});
    request.setAttribute(&quot;bigCities&quot;,bigCities);
%&gt;

&lt;c:forEach var=&quot;mapItem&quot; items=&quot;${bigCities}&quot;&gt;
    ${mapItem.key} :
        &lt;c:forEach var=&quot;city&quot; items=&quot;${mapItem.value}&quot;&gt;
            ${city}
        &lt;/c:forEach&gt;
    &lt;br/&gt;
&lt;/c:forEach&gt;
</code></pre><p>遍历Map</p>
<pre><code>&lt;%
    Map&lt;String, String&gt; capitals = new HashMap&lt;String,String&gt;();
    capitals.put(&quot;Indonesia&quot;,&quot;Jakarta&quot;);
    capitals.put(&quot;Malaysia&quot;,&quot;Kuala Lumpur&quot;);
    capitals.put(&quot;Thailand&quot;,&quot;Bangkok&quot;);
    request.setAttribute(&quot;capitals&quot;,capitals);
%&gt;

&lt;c:forEach var=&quot;capital&quot; items=&quot;${capitals}&quot;&gt;
    ${capital.key} ${capital.value} &lt;br/&gt;
&lt;/c:forEach&gt;
</code></pre><p>日期</p>
<pre><code>&lt;fmt:formatDate value=&quot;${o.confirmDate}&quot;  type=&quot;date&quot; /&gt;
&lt;fmt:parseDate value=&quot;${now}&quot; var=&quot;parsedEmpDate&quot; pattern=&quot;dd-MM-yyyy&quot; /&gt;
</code></pre><p><img src="http://i.imgur.com/ij3bwfi.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Mr.Qian" />
          <p class="site-author-name" itemprop="name">Mr.Qian</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">139</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">86</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr.Qian</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
