<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="算法,数据结构," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="归并排序12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455import java.util.*;public class Solution &amp;#123;    private int[] temp;    public void mergeSort">
<meta name="keywords" content="算法,数据结构">
<meta property="og:type" content="article">
<meta property="og:title" content="6、求逆序数">
<meta property="og:url" content="http://qianmingxs.com/2017/06/13/[数据结构与算法]6、求逆序数/index.html">
<meta property="og:site_name" content="Mr.Qian&#39;s Home">
<meta property="og:description" content="归并排序12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455import java.util.*;public class Solution &amp;#123;    private int[] temp;    public void mergeSort">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-07-19T07:22:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6、求逆序数">
<meta name="twitter:description" content="归并排序12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455import java.util.*;public class Solution &amp;#123;    private int[] temp;    public void mergeSort">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'PERBMK758D',
      apiKey: 'bb735480ebfad21cf22f48a7a44c066a',
      indexName: 'Hexo',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://qianmingxs.com/2017/06/13/[数据结构与算法]6、求逆序数/"/>





  <title>6、求逆序数 | Mr.Qian's Home</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mr.Qian's Home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://qianmingxs.com/2017/06/13/[数据结构与算法]6、求逆序数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Qian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Qian's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">6、求逆序数</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-13T21:13:00+08:00">
                2017-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构与算法/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构与算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">import java.util.*;</div><div class="line"></div><div class="line">public class Solution &#123;</div><div class="line"></div><div class="line">    private int[] temp;</div><div class="line"></div><div class="line">    public void mergeSort(int[] a, int l, int r) &#123;</div><div class="line">        //递归结束</div><div class="line">        if (l &gt;= r) &#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        //防止溢出，或者也可以写int mid = l + (r - l) &gt;&gt;1 ，是1哦</div><div class="line">        int mid = l + (r - l) / 2;</div><div class="line">        //分治</div><div class="line">        mergeSort(a, l, mid);</div><div class="line">        mergeSort(a, mid + 1, r);</div><div class="line">        //两个有序数组l..mid，mid+1..r,合并成一个有序数组</div><div class="line">        merge(a, l, mid, r);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void merge(int[] a, int l, int mid, int r) &#123;</div><div class="line">        if (temp == null) &#123;</div><div class="line">            temp = new int[a.length];</div><div class="line">        &#125;</div><div class="line">        //先复制原数据至临时数组temp，接下来对temp进行操作，排序后覆写数组a</div><div class="line">        for (int i = l; i &lt;= r; i++) &#123;</div><div class="line">            temp[i] = a[i];</div><div class="line">        &#125;</div><div class="line">        //双指针,不要忘记指针++</div><div class="line">        int lp = l, rp = mid + 1;</div><div class="line">        for (int i = l; i &lt;= r; i++) &#123;</div><div class="line">            if (lp &gt; mid) &#123;</div><div class="line">                a[i] = temp[rp++];</div><div class="line">            &#125; else if (rp &gt; r) &#123;</div><div class="line">                a[i] = temp[lp++];</div><div class="line">            &#125; else &#123;</div><div class="line">                if (temp[lp] &lt; temp[rp]) &#123;</div><div class="line">                    a[i] = temp[lp++];</div><div class="line">                &#125; else &#123;</div><div class="line">                    a[i] = temp[rp++];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        Solution s = new Solution();</div><div class="line">        int[] array = &#123;1, 2, 3, 4, 5, 6, 7, 0&#125;;</div><div class="line">        s.mergeSort(array, 0, array.length - 1);</div><div class="line">        for (int i = 0; i &lt; array.length; i++) &#123;</div><div class="line">            System.out.print(array[i] + &quot; &quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="归并排序的基础上求逆序数-推荐从后往前"><a href="#归并排序的基础上求逆序数-推荐从后往前" class="headerlink" title="归并排序的基础上求逆序数(推荐从后往前)"></a>归并排序的基础上求逆序数(推荐从后往前)</h2><p>OJ：<a href="https://www.nowcoder.com/practice/96bd6684e04a44eb80e6a68efc0ec6c5?tpId=13&amp;tqId=11188&amp;tPage=2&amp;rp=2&amp;ru=/ta/coding-interviews&amp;qru=/ta/coding-interviews/question-ranking" target="_blank" rel="external">https://www.nowcoder.com/practice/96bd6684e04a44eb80e6a68efc0ec6c5?tpId=13&amp;tqId=11188&amp;tPage=2&amp;rp=2&amp;ru=/ta/coding-interviews&amp;qru=/ta/coding-interviews/question-ranking</a></p>
<p>1、两个有序数组从前往后合并成一个有序数组</p>
<ul>
<li>如果A&lt;=B，A指针往后移：因为A、B都是有序的，A&lt;=B之后的元素，相当于A与B之后的元素全部进行比较过</li>
<li>如果A&gt;B，B指针往后移：B比A之后的元素都小，根据数组有序的特点，可以减少比较次数</li>
</ul>
<p>当A&gt;B时统计逆序数，B指针后移，此时A及A后面的元素组成逆序数对（A，B）、（A1，B）、（A2，B）…</p>
<p>综上所述，从前往后归并，是根据在前面查找<strong>比他大</strong>的数的个数</p>
<p>思考：从前往后合并，如果想要统计比A小的元素的个数？<br>见leetcode那题，当A&lt;=B时，需要移动lp时，记录count；当A&gt;=B时，count++</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">import java.util.*;</div><div class="line"></div><div class="line">public class Solution &#123;</div><div class="line"></div><div class="line">    private int[] temp;</div><div class="line">    private int inverseNum;</div><div class="line"></div><div class="line">    public int InversePairs(int[] array) &#123;</div><div class="line">        mergeSort(array, 0, array.length - 1);</div><div class="line">        return inverseNum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void mergeSort(int[] a, int l, int r) &#123;</div><div class="line">        //递归结束</div><div class="line">        if (l == r) &#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        //防止溢出，或者也可以写int mid = l + (r - l) &gt;&gt;1 ，是1哦</div><div class="line">        int mid = l + (r - l) / 2;</div><div class="line">        //分治</div><div class="line">        mergeSort(a, l, mid);</div><div class="line">        mergeSort(a, mid + 1, r);</div><div class="line">        //两个有序数组l..mid，mid+1..r,合并成一个有序数组</div><div class="line">        merge(a, l, mid, r);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void merge(int[] a, int l, int mid, int r) &#123;</div><div class="line">        if (temp == null) &#123;</div><div class="line">            temp = new int[a.length];</div><div class="line">        &#125;</div><div class="line">        //先复制原数据至临时数组temp，接下来对temp进行操作，排序后覆写数组a</div><div class="line">        for (int i = l; i &lt;= r; i++) &#123;</div><div class="line">            temp[i] = a[i];</div><div class="line">        &#125;</div><div class="line">        //双指针,不要忘记指针++</div><div class="line">        /*int lp = l, rp = mid + 1;</div><div class="line">        for (int i = l; i &lt;= r; i++) &#123;</div><div class="line">            if (lp &gt; mid) &#123;</div><div class="line">                a[i] = temp[rp++];</div><div class="line">            &#125; else if (rp &gt; r) &#123;</div><div class="line">                a[i] = temp[lp++];</div><div class="line">            &#125; else &#123;</div><div class="line">                if (temp[lp] &lt; temp[rp]) &#123;</div><div class="line">                    a[i] = temp[lp++];</div><div class="line">                &#125; else &#123;</div><div class="line">                    a[i] = temp[rp++];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;*/</div><div class="line"></div><div class="line">        //注释归并的部分。求逆序数，左右两个数组的每个数都要进行比较！！</div><div class="line">        int lp = l, rp = mid + 1;</div><div class="line">        for (int i = l; i &lt;= r; i++) &#123;</div><div class="line">            if (lp &gt; mid) &#123;</div><div class="line">                a[i] = temp[rp++];</div><div class="line">            &#125; else if (rp &gt; r) &#123;</div><div class="line">                a[i] = temp[lp++];</div><div class="line">            &#125; else &#123;</div><div class="line">                if (temp[lp] &lt; temp[rp]) &#123;</div><div class="line">                    a[i] = temp[lp++];</div><div class="line">                &#125; else if (temp[lp] &gt; temp[rp]) &#123;</div><div class="line">                    //3,4 1,2 如果1比3小,那么3,4都比1大</div><div class="line">                    inverseNum = (inverseNum + (mid - lp + 1)) % 1000000007;</div><div class="line">                    a[i] = temp[rp++];</div><div class="line">                &#125; else &#123;</div><div class="line">                    a[i] = temp[lp++];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    /*public static void main(String[] args) &#123;</div><div class="line">        Solution s = new Solution();</div><div class="line">        int[] array = &#123;1, 2, 3, 4, 5, 6, 7, 0, 1&#125;;</div><div class="line">        System.out.println(s.InversePairs(array));</div><div class="line">    &#125;*/</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2、两个有序数组从后往前合并成一个有序数组</p>
<ul>
<li>如果A&gt;B，A指针往前移：因为A、B都是有序的，A&gt;B之前的元素，相当于A与B之前的元素全部进行比较过</li>
<li>如果A&lt;=B，B指针往前移：B比A之前的元素都大，根据数组有序的特点，可以减少比较次数</li>
</ul>
<p>当A&gt;B时统计逆序数，A指针前移，此时B及B之前的元素组成逆序数对（A，B）、（A，B1）、（A，B2）…</p>
<p>综上所述，从后往前归并，是根据在后面查找<strong>比他小</strong>的数的个数</p>
<p>OJ:<a href="https://leetcode.com/problems/count-of-smaller-numbers-after-self/#/description" target="_blank" rel="external">https://leetcode.com/problems/count-of-smaller-numbers-after-self/#/description</a></p>
<pre>
import java.util.*;

public class Solution {

    private int[] nums;
    private int[] new_indexs;
    private List<integer> result = new ArrayList<integer>();

    /**
     * 对下标进行归并排序，原数组不变化
     */
    public List<integer> countSmaller(int[] nums) {
        //初始化result
        for (int i = 0; i < nums.length; i++) {
            result.add(0);
        }
        //原数组的下标，对下标进行归并排序
        int[] indexs = new int[nums.length];
        for (int i = 0; i < indexs.length; i++) {
            indexs[i] = i;
        }
        this.nums = nums;
        mergeSort(indexs, 0, indexs.length - 1);
        return result;
    }

    public void mergeSort(int[] indexs, int l, int r) {
        //递归结束，必须是l>=r，如果数组为空会造成递归不停止
        if (l >= r) {
            return;
        }
        //防止溢出，或者也可以写int mid = l + (r - l) >>1 ，是1哦
        int mid = l + (r - l) / 2;
        //分治
        mergeSort(indexs, l, mid);
        mergeSort(indexs, mid + 1, r);
        //两个有序数组l..mid，mid+1..r,合并成一个有序数组
        merge(indexs, l, mid, r);
    }

    public void merge(int[] indexs, int l, int mid, int r) {
        if (new_indexs == null) {
            new_indexs = new int[indexs.length];
        }
        //先复制原数据至临时数组，接下来对temp进行操作，排序后覆写数组
        for (int i = l; i <= r;="" i++)="" {="" new_indexs[i]="indexs[i];" }="" 注释归并的部分。求逆序数，左右两个数组的**每个数**都要进行比较！但是因为是数组是有序的，所以可以减少比较次数="" int="" lp="mid," rp="r;" <font="" color="red">for (int i = r; i >= l; i--) {
            if (lp < l) {
                indexs[i] = new_indexs[rp--];
            } else if (rp < mid + 1) {
                indexs[i] = new_indexs[lp--];
            } else {
                if (nums[new_indexs[lp]] > nums[new_indexs[rp]]) {
                    //移动lp之前，统计比lp小的个数
                    <font color="red">result.set(new_indexs[lp], result.get(new_indexs[lp]) + rp - mid);</font>
                    indexs[i] = new_indexs[lp--];
                } else {
                    indexs[i] = new_indexs[rp--];
                }
            }
        }
    }


    /*public static void main(String[] args) {
        Solution s = new Solution();
        int[] array = {1, 9, 7, 8, 5};
        System.out.println(s.countSmaller(array));//03110
    }*/
}
</=></integer></integer></integer></pre>

<h2 id="Leetcode"><a href="#Leetcode" class="headerlink" title="Leetcode"></a>Leetcode</h2><p>The basic idea is to do merge sort to nums[]. To record the result, we need to keep the index of each number in the original array. So instead of sort the number in nums, we sort the indexes of each number.<br>Example: nums = [5,2,6,1], indexes = [0,1,2,3]<br>After sort: indexes = [3,1,0,2]</p>
<p>While doing the merge part, say that we are merging left[] and right[], left[] and right[] are already sorted.</p>
<p>We keep a rightcount to record how many numbers from right[] we have added and keep an array count[] to record the result.</p>
<p>When we move a number from <strong>right[]</strong> into the new sorted array, we <strong>increase rightcount by 1.</strong></p>
<p>When we move a number from <strong>left[]</strong> into the new sorted array, we <strong>increase count[ index of the number ] by rightcount.</strong></p>
<pre>
import java.util.*;

public class Solution {

    private int[] nums;
    private int[] new_indexs;
    private List<integer> result = new ArrayList<integer>();

    /**
     * 对下标进行归并排序，原数组不变化
     */
    public List<integer> countSmaller(int[] nums) {
        //初始化result
        for (int i = 0; i < nums.length; i++) {
            result.add(0);
        }
        //原数组的下标，对下标进行归并排序
        int[] indexs = new int[nums.length];
        for (int i = 0; i < indexs.length; i++) {
            indexs[i] = i;
        }
        this.nums = nums;
        mergeSort(indexs, 0, indexs.length - 1);
        return result;
    }

    public void mergeSort(int[] indexs, int l, int r) {
        //递归结束，必须是l>=r，如果数组为空会造成递归不停止
        <font color="red">if (l >= r) {
            return;
        }</font>
        //防止溢出，或者也可以写int mid = l + (r - l) >>1 ，是1哦
        int mid = l + (r - l) / 2;
        //分治
        mergeSort(indexs, l, mid);
        mergeSort(indexs, mid + 1, r);
        //两个有序数组l..mid，mid+1..r,合并成一个有序数组
        merge(indexs, l, mid, r);
    }

    public void merge(int[] indexs, int l, int mid, int r) {
        if (new_indexs == null) {
            new_indexs = new int[indexs.length];
        }
        //先复制原数据至临时数组，接下来对temp进行操作，排序后覆写数组
        for (int i = l; i <= r;="" i++)="" {="" new_indexs[i]="indexs[i];" }="" 注释归并的部分。求逆序数，左右两个数组的**每个数**都要进行比较！但是因为是数组是有序的，所以可以减少比较次数="" int="" count="0;" lp="l," rp="mid" +="" 1;="" for="" (int="" i="l;" <="r;" if="" (lp=""> mid) {
                indexs[i] = new_indexs[rp++];
            } else if (rp > r) {
                //lp移动的时候要加count
                <font color="red">result.set(new_indexs[lp], result.get(new_indexs[lp]) + count);</font>
                indexs[i] = new_indexs[lp++];
            } else {
                if (nums[new_indexs[lp]] <= nums[new_indexs[rp]])="" {="" 移动lp之前，统计比lp小的个数="" <font="" color="red">result.set(new_indexs[lp], result.get(new_indexs[lp]) + count);
                    indexs[i] = new_indexs[lp++];
                } else {
                    <font color="red">count++;</font>
                    indexs[i] = new_indexs[rp++];
                }
            }
        }
    }


    /*public static void main(String[] args) {
        Solution s = new Solution();
        int[] array = {1, 9, 7, 8, 5};
        System.out.println(s.countSmaller(array));//03110
    }*/
}
</=></=></integer></integer></integer></pre>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/算法/" rel="tag"># 算法</a>
          
            <a href="/tags/数据结构/" rel="tag"># 数据结构</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/11/[分布式架构]一致性哈希算法/" rel="next" title="一致性哈希算法">
                <i class="fa fa-chevron-left"></i> 一致性哈希算法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/14/[数据结构与算法]7、稳定排序与不稳定排序/" rel="prev" title="7、稳定排序与不稳定排序">
                7、稳定排序与不稳定排序 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Mr.Qian" />
          <p class="site-author-name" itemprop="name">Mr.Qian</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">144</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">87</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#归并排序"><span class="nav-number">1.</span> <span class="nav-text">归并排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#归并排序的基础上求逆序数-推荐从后往前"><span class="nav-number">2.</span> <span class="nav-text">归并排序的基础上求逆序数(推荐从后往前)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Leetcode"><span class="nav-number">3.</span> <span class="nav-text">Leetcode</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr.Qian</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.1"></script>



  

  

  

  

  

  

</body>
</html>
